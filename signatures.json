[
    {"test": "contains", "contains": ["product", "MikroTik"], "name": "MikroTik", "filter": "tcp/2000", "result": {"type": "Router", "os": "RouterOS", "device": "MikroTik Router"}},
    {"ref": "https://www.mdsec.co.uk/2016/10/building-an-iot-botnet-bsides-manchester-2016/", "test": "contains", "result": {"type": "Camera", "os": "Unknown", "device": "HikVision DVR device"}, "name": "HikVision DVR DNVRS-Webs web server", "contains": ["data", "Server: DNVRS-Webs"], "filter": "tcp/80"},
    {"ref": "https://www.mdsec.co.uk/2016/10/building-an-iot-botnet-bsides-manchester-2016/", "test": "contains", "result": {"type": "Camera", "device": "HikVision DVR device"}, "name": "HikVision DVR DVRDVS-Webs web server", "contains": ["data", "Server: DVRDVS-Webs"], "filter": "tcp/80"},
    {"test": "contains", "contains": ["data", "Technicolor"], "name": "Technicolor SNMP", "filter": "udp/161", "result": {"type": "Router", "device": "Technicolor"}},
    {"test": "contains", "contains": ["data", "TD854W"], "name": "TPLink web admin interface", "filter": "tcp/80", "result": {"type": "Router", "device": "TPLink TD854W"}},
    {"test": "contains", "contains": ["data", "ASUS RT-AC3100"], "name": "ASUS RT-AC3100 FTP banner", "filter": "tcp/21", "result": {"type": "Router", "device": " ASUS RT-AC3100"}},
    {"test": "contains", "contains": ["data", "Thomson CableHome Gateway"], "name": "Thomson CableHome Gateway SNMP", "filter": "udp/161", "result": {"type": "Router", "device": "Thomson CableHome Gateway"}},
    {"test": "contains", "contains": ["html", "Technicolor - M\u00f3dem"], "name": "Technicolor admin page", "filter": "tcp/80", "result": {"type": "Router", "device": "Technicolor Model"}},
    {"test": "contains", "contains": ["data", "<title>D-LINK</title>"], "name": "D-LINK admin page", "filter": "tcp/8181", "result": {"type": "Router", "device": "D-LINK router"}},
    {"test": "contains", "contains": ["data", "Digest realm=\"IgdAuthentication\""], "name": "IgdAuthentication realm", "filter": "tcp/7547", "result": {"type": "Router", "device": "unknown"}},
    {"test": "regex", "result": {"type": "Router", "device": "D-LINK"}, "name": "D-LINK UPNP uuid", "filter": "udp/1900", "regex": "\\/dyndev\\/uuid\\:\\w+-\\w+-\\w+-\\w+-1cbdb9\\w+"},
    {"test": "regex", "result": {"type": "Router", "device": "ZTE Router"}, "name": "ZTE UPNP uuid", "filter": "udp/1900", "regex": "\\/dyndev\\/uuid\\:\\w+-\\w+-\\w+-\\w+-002293\\w+"},
    {"test": "contains", "contains": ["html", "# Copyright (C) 2009, CyberTAN Corporation\r\n# All Rights Reserved."], "name": "Linksys Router admin page header", "filter": "tcp/8080", "result": {"type": "Router", "device": "Linksys"}},
    {"test": "contains", "contains": ["html", "# Copyright (C) 2009, CyberTAN Corporation\r\n# All Rights Reserved."], "name": "Linksys Router admin page header", "filter": "tcp/8081", "result": {"type": "Router", "device": "Linksys"}},
    {"test": "contains", "contains": ["data", "Server: cisco-IOS"], "name": "Cisco iOS admin interface", "filter": "tcp/8080", "result": {"type": "Router", "device": "Cisco iOS Router"}},
    {"test": "contains", "contains": ["data", "SSH-2.0-DraySSH_2.0"], "name": "DrayTek Vigor ADSL router sshd", "filter": "tcp/22", "result": {"type": "Router", "device": "DrayTek Vigor ADSL router sshd"}},
    {"test": "contains", "contains": ["data", "Set-Cookie: AIROS_"], "name": "AirOS Set Cookie admin age", "filter": "tcp/443", "result": {"type": "Router", "device": "AirOS router"}},
    {"test": "contains", "contains": ["data", "Digest realm=\"Hikvision\""], "name": "Hikvision HTTP Authentication", "filter": "tcp/554", "result": {"type": "Router", "device": "HikVision DVR device"}},
    {"test": "contains", "contains": ["data", "Basic realm=\"DahuaRtsp\""], "name": "Dahua RTSP authentication", "filter": "tcp/554", "result": {"type": "Camera", "device": "Dahua DVR Camera"}},
    {"test": "contains", "contains": ["data", "Digest realm=\"HuaweiHomeGateway\""], "name": "Huawei Home gateway AuthRealm", "filter": "tcp/7547", "result": {"type": "Router", "device": "Huawei Home Gateway"}},
    {"test": "contains", "contains": ["data", "Digest realm=\"realtek.com"], "name": "Realtek Gateway Auth realm", "filter": "tcp/7547", "result": {"type": "Router", "device": "RealTek Router"}},
    {"test": "contains", "contains": ["data", "OS 1.0 UPnP/1.0 Realtek/"], "name": "Realtek UPnP", "filter": "udp/1900", "result": {"type": "Router", "device": "RealTek Router"}},
    {"test": "contains", "contains": ["data", "150Mbps Wireless N Router TL-WR720N"], "name": "TPLink Wireless TL-WR720N Basic Realm", "filter": "tcp/80", "result": {"type": "Router", "device": "TPLink TL-WR720N Wireless Router"}},
    {"test": "regex", "result": {"type": "Server", "device": "Fedora Server"}, "name": "Apache Fedora", "filter": "tcp/80", "regex": "Apache\\/\\d+\\.\\d+\\.\\d+ \\(Fedora\\)"},
    {"test": "contains", "contains": ["data", "Server: H264DVR"], "name": "RTSP H264DVR Server", "filter": "tcp/554", "result": {"type": "Camera", "device": "H.264 DVR"}},
    {"test": "contains", "contains": ["data", "Digest realm=\"cpe@zte.com\""], "name": "ZTE Router Digest realm", "filter": "tcp/7547", "result": {"type": "Router", "device": "ZTE Router"}},
    {"test": "contains", "contains": ["ssl.cert.subject.emailAddress", "mobile.wifi@huawei.com"], "name": "Huawei Wifi Router cert", "filter": "tcp/443", "result": {"type": "Router", "device": "Huawei Wifi Router"}},
    {"test": "contains", "contains": ["html", "<title>D-LINK SYSTEMS, INC. | WIRELESS ROUTER </title>"], "name": "D-LINK admin page", "filter": "tcp/8080", "result": {"type": "Router", "device": "D-LINK Wireless router"}},
    {"test": "contains", "contains": ["data", "RouterOS"], "name": "MikroTik SNMP info", "filter": "udp/161", "result": {"type": "Router", "device": "MikroTik Router"}},
    {"test": "contains", "contains": ["ssl.cert.issuer.O", "DahuaTech"], "name": "Dahua DVR certificate", "filter": "tcp/443", "result": {"type": "Camera", "device": "Dahua DVR"}},
    {"test": "contains", "contains": ["http.title", "Vigor Login Page"], "name": "Daytek Vigor admin page", "filter": "tcp/8080", "result": {"type": "Router", "device": "Daytek Vigor Router"}},
    {"test": "contains", "contains": ["data", "MikroTik"], "name": "MikroTik telnet server", "filter": "tcp/23", "result": {"type": "Router", "device": "MikroTik Router"}},
    {"test": "contains", "contains": ["data", "Microsoft IIS httpd"], "name": "MS IIS header", "filter": "tcp/80", "result": {"type": "Server", "os": "Windows", "device": "Windows Server"}},
    {"test": "contains", "contains": ["data", "Server: Microsoft-IIS/"], "name": "MS IIS header", "filter": "tcp/80", "result": {"type": "Server", "os": "Windows", "device": "Windows Server"}},
    {"test": "contains", "contains": ["data", "Server: Microsoft-IIS/"], "name": "MS IIS header port 8080", "filter": "tcp/8080", "result": {"type": "Server", "os": "Windows", "device": "Windows Server"}},
    {"test": "contains", "contains": ["smb.os", "Windows Server 2008"], "name": "SMB Windows Server 2008", "filter": "tcp/445", "result": {"type": "Server", "device": "Windows Server 2008"}},
    {"ref": "http://www.4ipnet.com/products/wlan-gateway-controller/WHG325", "test": "contains", "result": {"type": "Router", "device": "4ipnet WHG325 Router"}, "name": "4ipnet WHG325 admin page", "contains": ["http.title", "WHG325"], "filter": "tcp/80"},
    {"test": "contains", "contains": ["data", "FTP server (MikroTik"], "name": "MikroTik FTP server", "filter": "tcp/21", "result": {"type": "Router", "os": "RouterOS", "device": "MikroTik Router"}},
        {"test": "contains", "contains": ["html", "window.location=\"https://\" + SSLHostIp + \":\" + SSLPort;"], "name": "AVIO CCTV system", "filter": "tcp/80", "result": {"type": "Camera", "device": "AVIO CCTV DVR system"}},
        {"test": "contains", "contains": ["data", "Hostname: Grace Broadband"], "name": "Grace Communications PPTP info", "filter": "tcp/1723", "result": {"type": "Router", "device": "Grace Communications Wireless Router"}},
        {"test": "contains", "contains": ["data", "Hostname: MikroTik"], "name": "MikroTik PPTP server", "filter": "tcp/1723", "result": {"type": "Router", "os": "RouterOS", "device": "MikroTik Router"}},
        {"test": "contains", "contains": ["data", "W3400V6"], "name": "Innacomm W3400V6 ADSL Router SNMP header", "filter": "udp/161", "result": {"type": "Router", "device": "Innacomm W3400V6 ADSL Router"}},
        {"ref": "http://www.tendacn.com/en/product/d301.html", "test": "contains", "result": {"type": "Router", "device": "Tenda D301 Router"}, "name": "Tenda D301 Router admin page", "contains": ["html", "<title>D301</title>"], "filter": "tcp/80"},
        {"test": "contains", "contains": ["data", "TP-LINK Wireless N Router WR840N"], "name": "TP-LINK WR840N Basic realm", "filter": "tcp/8080", "result": {"type": "Router", "device": "TP-LINK Wireless N Router WR840N"}},
        {"test": "contains", "contains": ["html", "<title>Tenda 11N Wireless Router Login Screen</title>"], "name": "Tenda 11N Wireless Router Login Screen", "filter": "tcp/8080", "result": {"type": "Router", "device": "Tenda 11N Wireless Router"}},
        {"test": "contains", "contains": ["data", "Server: Hikvision-Webs"], "name": "Hikvision web server", "filter": "tcp/80", "result": {"type": "Camera", "device": "Hikvision DVR system"}},
        {"test": "contains", "contains": ["html", "<meta name=\"description\" content=\"DiskStation provides a full-featured network attached storage (NAS) solution to help you manage, backup and share data among Windows, Mac and Linux easily.\" />"], "name": "Synology NAS admin page", "filter": "tcp/5001", "result": {"type": "NAS", "device": "Synology DiskStation"}},
        {"test": "contains", "contains": ["data", "EchoLife Home Gateway"], "name": "Huawei EchoLife HG520 Home Gateway", "filter": "tcp/80", "result": {"type": "Router", "device": "Huawei EchoLife Router"}},
        {"test": "contains", "contains": ["html", "<title>Linksys Smart Wi-Fi</title>"], "name": "Linksys Smart Wi-Fi admin page", "filter": "tcp/80", "result": {"type": "Router", "device": "Linksys router"}},
        {"ref": "https://en.wikipedia.org/wiki/Fritz!Box", "test": "contains", "result": {"type": "Router", "device": "Fritz!Box ADSL Router"}, "name": "FRITZ!Box admin page", "contains": ["html", "\"pageTitle\":\"Welcome to your FRITZ!Box\""], "filter": "tcp/443"},
        {"test": "contains", "contains": ["html", "var ProductName = 'HG8247H';"], "name": "Huawei HG8247H admin page", "filter": "tcp/80", "result": {"type": "Router", "device": "Huawei HG8247H"}},
        {"test": "contains", "contains": ["data", "TD-W8901G"], "name": "TP-LINK TD-W8901G SNMP", "filter": "udp/25033", "result": {"type": "Router", "device": "TP-Link TD-W8901G Router"}},
        {"test": "contains", "contains": ["html", "window.location.href = \"/doc/page/login.asp?_\" + (new Date()).getTime();"], "name": "Hikvision admin panel", "filter": "tcp/8080", "result": {"type": "Camera", "device": "Hikvision DVR system"}},
        {"test": "contains", "contains": ["data", "Microsoft ESMTP MAIL Service"], "name": "Microsoft ESMTP Mail service", "filter": "tcp/587", "result": {"type": "Server", "os": "Windows", "device": "Windows Server"}},
        {"test": "contains", "contains": ["ssl.cert.issuer.CN", "Cisco"], "name": "Cisco Router admin panel", "filter": "tcp/443", "result": {"type": "Router", "device": "Cisco router"}},
        {"test": "contains", "contains": ["ssl.cert.subject.O", "Multitech"], "name": "Multitech admin panel certificate", "filter": "tcp/443", "result": {"type": "Router", "device": "Multitech Router"}},
        {"ref": "https://forum.hardware.fr/hfr/HardwarePeripheriques/Divers/sagembox-twonkymedia-sujet_49647_1.htm", "test": "contains", "result": {"type": "Router", "device": "SAGEMBOX Routers"}, "name": "SAGEMBOX NetBIOS servername", "contains": ["data", "NetBIOS Response\nServername: SAGEMBOX"], "filter": "udp/137"},
        {"test": "regex", "result": {"type": "Router", "device": "Huawei router"}, "name": "Huawei ssh server", "filter": "tcp/22", "regex": "SSH-\\d+\\.\\d+-HUAWEI-"},
        {"test": "contains", "contains": ["ssl.cert.issuer.emailAddress", "support@fortinet.com"], "name": "Fortinet router certificate", "filter": "tcp/443", "result": {"type": "Router", "device": "Fortinet router"}},
        {"test": "contains", "contains": ["data", "(DIR850L Samba Server)"], "name": "D-LINK Samba server", "filter": "tcp/445", "result": {"type": "Router", "device": "D-LINK DIR-850L wireless cloud router"}},
        {"test": "contains", "contains": ["data", "Skyworth"], "name": "Skyworth model SNMP banner", "filter": "udp/161", "result": {"type": "Router", "device": "Skyworth Wireless cable model"}},
        {"test": "contains", "contains": ["data", "Ubiquiti Networks Device"], "name": "Ubiquiti AirRouter udp 10001", "filter": "udp/10001", "result": {"type": "Router", "os": "airOS", "device": "Ubiquiti AirRouter"}},
        {"test": "contains", "contains": ["http.title", "RouterOS router configuration page"], "name": "Mikrotik RouterOS configuration page", "filter": "tcp/80", "result": {"type": "Router", "os": "RouterOS", "device": "Mikrotik Router"}},
        {"test": "contains", "contains": ["html", "(Mikrotik HttpProxy)"], "name": "Mikrotik HTTP Proxy", "filter": "tcp/8080", "result": {"type": "Router", "device": "Mikrotik Router"}},
        {"test": "contains", "contains": ["html", "var LoginTimes = 0;\r\n\r\nvar ProductName = 'HG8245';"], "name": "Huawei HG8245 login page", "filter": "tcp/80", "result": {"type": "Router", "device": "Huawei HG8245 Router"}},
        {"test": "contains", "contains": ["data", "SERCOMM CPE Authentication"], "name": "SERCOMM authentication realm", "filter": "tcp/8081", "result": {"type": "Router", "device": "SerComm router"}},
        {"test": "contains", "contains": ["data", "Product: N5B-16"], "name": "Ubiquiti N5D-16M", "filter": "udp/10000", "result": {"type": "Router", "device": "Ubiquiti N5B-16 Airmax router"}},
        {"test": "contains", "contains": ["data", "Remote Desktop Protocol"], "name": "Windows RDP Server", "filter": "tcp/3389", "result": {"type": "Server", "os": " Windows", "device": "Windows Server"}},
        {"test": "contains", "contains": ["data", "X-Your-Address-Is:"], "name": "Tor Exit Router HTTP header", "filter": "tcp/80", "result": {"type": "Server", "device": "Tor router"}},
        {"test": "contains", "contains": ["data", "X-Your-Address-Is:"], "name": "Tor Exit Router HTTP header", "filter": "tcp/444", "result": {"type": "Server", "device": "Tor router"}},
        {"test": "contains", "contains": ["data", "X-Your-Address-Is:"], "name": "Tor Exit Router HTTP header", "filter": "tcp/8080", "result": {"type": "Server", "device": "Tor router"}},
        {"test": "contains", "contains": ["data", "X-Your-Address-Is:"], "name": "Tor Exit Router HTTP header", "filter": "tcp/9001", "result": {"type": "Server", "device": "Tor router"}},
        {"test": "contains", "contains": ["data", "NetBIOS Response"], "name": "Windows NetBIOS", "filter": "udp/137", "result": {"type": "Server", "device": "Windows System"}},
        {"test": "contains", "contains": ["data", "Server: Microsoft-HTTPAPI"], "name": "Windows with MS HTTPAPI Web Server", "filter": "tcp/80", "result": {"type": "Server", "device": "Windows Server"}},
        {"test": "contains", "contains": ["data", "Microsoft FTP Service"], "name": "MS FTP Service", "filter": "tcp/21", "result": {"type": "Server", "device": "Windows system"}},
        {"test": "contains", "contains": ["data", "ubuntu"], "name": "Ubuntu-ssh", "filter": "tcp/22", "result": {"type": "Server", "device": "Ubuntu Server"}},
        {"test": "regex", "result": {"type": "Server", "os": "Linux", "device": "Ubuntu Server"}, "name": "Ubuntu Apache header", "filter": "tcp/80", "regex": "Server\\: Apache\\/\\d+\\.\\d+\\.\\d+ \\(Ubuntu\\)"},
        {"test": "regex", "result": {"type": "Server", "os": "Linux", "device": "Ubuntu Server"}, "name": "Ubuntu Apache header", "filter": "tcp/443", "regex": "Server\\: Apache\\/\\d+\\.\\d+\\.\\d+ \\(Ubuntu\\)"},
        {"test": "regex", "result": {"type": "Server", "os": "Linux", "device": "Ubuntu Server"}, "name": "Ubuntu Apache header", "filter": "tcp/8080", "regex": "Server\\: Apache\\/\\d+\\.\\d+\\.\\d+ \\(Ubuntu\\)"},
        {"test": "contains", "contains": ["html", "<title>Apache2 Ubuntu Default Page: It works</title>"], "name": "Ubuntu Apache default page", "filter": "tcp/80", "result": {"type": "Server", "os": "Linux", "device": "Ubuntu server"}},
        {"test": "regex", "result": {"type": "Server", "os": "Linux", "device": "Debian Server"}, "name": "Debian ssh header", "filter": "tcp/22", "regex": "SSH-\\d+\\.\\d+-OpenSSH_\\d+\\.\\d+p\\d+ Debian"},
        {"test": "regex", "result": {"type": "Server", "os": "Linux", "device": "Ubuntu Server"}, "name": "Ubuntu ssh header", "filter": "tcp/22", "regex": "SSH-\\d+\\.\\d+-OpenSSH_\\d+\\.\\d+p\\d+ Ubuntu"},
        {"test": "regex", "result": {"type": "Server", "os": "Linux", "device": "Ubuntu Server"}, "name": "Ubuntu ssh header port 2222", "filter": "tcp/2222", "regex": "SSH-\\d+\\.\\d+-OpenSSH_\\d+\\.\\d+p\\d+ Ubuntu"},
        {"test": "contains", "contains": ["data", "-Debian"], "name": "Debian bind header", "filter": "udp/53", "result": {"type": "Server", "os": "Linux", "device": "Debian Server"}},
        {"test": "regex", "result": {"type": "Server", "os": "FreeBSD", "device": "FreeBSD Server"}, "name": "FreeBSD Apache header", "filter": "tcp/80", "regex": "Apache/\\d+\\.\\d+\\.\\d+ \\(FreeBSD\\)"},
        {"test": "contains", "contains": ["data", "RedHat"], "name": "RedHat DNS header", "filter": "udp/53", "result": {"type": "Server", "os": "Linux", "device": "RedHat Server"}},
        {"test": "regex", "result": {"type": "Server", "device": "Red Hat Linux Server"}, "name": "Apache Red Hat", "filter": "tcp/80", "regex": "Server: Apache/\\d+\\.\\d+\\.\\d+ \\(Red Hat Linux\\)"},
        {"test": "contains", "contains": ["data", "Basic realm=\"ADSL Modem\""], "name": "ADSL Router", "filter": "tcp/80", "result": {"type": "Router", "device": "Unknown"}},
        {"test": "contains", "contains": ["data", "Server: DNVRS-Webs"], "name": "DVR DNVRS-Webs web server", "filter": "tcp/81", "result": {"type": "Camera", "device": "Unknown"}},
        {"test": "contains", "contains": ["data", "RomPager"], "name": "RomPager UPnP", "filter": "tcp/7547", "result": {"type": "Router", "device": "Unknown"}},
        {"test": "regex", "result": {"type": "Server", "device": "Windows Server"}, "name": "Apache Win32 header", "filter": "tcp/80", "regex": "Apache\\/\\d+\\.\\d+\\.\\d+ \\(Win32\\)"},
        {"test": "regex", "result": {"type": "Server", "device": "Windows Server"}, "name": "Apache Win32 header", "filter": "tcp/8080", "regex": "Apache\\/\\d+\\.\\d+\\.\\d+ \\(Win32\\)"},
        {"test": "regex", "result": {"type": "Server", "os": "Linux", "device": "CentOS Linux Server"}, "name": "Apache CentOS", "filter": "tcp/80", "regex": "Server: Apache/\\d+\\.\\d+\\.\\d+ \\(CentOS\\)"},
        {"test": "contains", "contains": ["data", "GoAhead-Webs"], "name": "GoAhead-Webs IoT web server", "filter": "tcp/443", "result": {"type": "IoT", "device": "Unknown"}}
]
